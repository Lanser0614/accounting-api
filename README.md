# API для учета финансов

## Как я использую SOLID принципы

### На уровне классов

1. **Single Responsibility**
   - `TransactionService` только для логики транзакций
   - `ExchangeRateFactory` создаёт драйвера и всё
   - Каждый драйвер работает только со своим форматом, не лезит в чужие

2. **Open/Closed**
   - Можно добавлять новые драйвера и не трогать старый код
   - Новые драйвера просто имплементят интерфейс
   - Стратегии конвертации добавляются без изменения основной логики

3. **Liskov Substitution**
   - Все драйвера работают через один интерфейс
   - В `AverageDriver` можно пихать любые драйвера
   - Контроллеры наследуются правильно

4. **Interface Segregation**
   - Интерфейс драйвера простой, ничего лишнего
   - DTO только для своих задач
   - Ресурсы форматируют только свои данные

5. **Dependency Inversion**
   - Контроллеры зависят от интерфейсов, а не от реализаций
   - Сервисы инжектятся через конструктор
   - Фасад для валют прячет реализацию

### На уровне архитектуры

1. **Модули**
   - Транзакции и валюты отдельно
   - У каждого модуля свои роуты и контроллеры
   - API отдельно от бизнес логики

2. **Сервисный слой**
   - Вся бизнес логика в сервисах
   - Контроллеры тонкие, только запросы/ответы
   - Всё разделено по слоям

3. **Фабрики**
   - `ExchangeRateFactory` создаёт нужные драйвера
   - Создание драйверов спрятано
   - Легко добавлять новые

4. **Репозитории**
   - Доступ к данным отдельно от логики
   - Модели для базы
   - Можно поменять источник данных

## Как я пишу PHPDoc

```php
/**
 * Конвертит сумму из одной валюты в другую по текущему курсу
 *
 * @param float $amount Сумма для конвертации
 * @param string $from Исходная валюта (например 'EUR')
 * @param string $to Целевая валюта (например 'USD')
 * @return float Сконвертированная сумма
 * @throws InvalidArgumentException Если коды валют неправильные
 */
```

## Что мне нравится в PHP 7+

1. **Типы**
   ```php
   public function getRate(string $from, string $to): float
   ```

2. **Оператор ??**
   ```php
   $driver = $driver ?? config('currency.default_driver')
   ```

3. **Стрелочные функции**
   ```php
   $rates = array_map(fn($rate) => $rate * 1.1, $baseRates)
   ```

4. **Конструктор с пропертями**
   ```php
   public function __construct(
       private TransactionService $service
   ) {}
   ```

5. **Match**
   ```php
   return match($driver) {
       'xml' => new XmlDriver(),
       'json' => new JsonDriver(),
       default => throw new \InvalidArgumentException("Не поддерживается"),
   };
   ```

### Что не нравится

1. **Нет дженериков**
   - Нужны для коллекций
   - Приходится писать в PHPDoc

2. **Нет нормальных проперти**
   - Нет встроенных геттеров/сеттеров

3. **Нет async/await**
   - Сложно писать асинхронный код
   - Нужны сторонние библиотеки

### Моё мнение про типизацию в PHP 7+

**Когда использую типы:**
1. В DTO и Value Objects чтоб данные были правильные
2. В сервисах где важна точность бизнес логики

**Когда не использую:**
1. При трансформации данных где нужна гибкость